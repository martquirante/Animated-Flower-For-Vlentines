performance.mark("js-parse-end:73494-540182b632e1b952.js");
"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([["73494"],{29775(e,t,i){i.d(t,{KY:()=>s.KY,Kv:()=>s.Kv,Op:()=>s.Op,tz:()=>r.tz,v0:()=>n.v0});var n=i(85020),s=i(14671),r=i(73652);i(69710)},14671(e,t,i){i.d(t,{KY:()=>k,Kv:()=>N,Op:()=>y});var n=i(35750),s=i(18150),r=i(85242),l=i(88243),a=i(16213),h=i(50467),o=i(35148),c=i(58388),u=i(85020),d=i(73652),f=i(69710),p=i(98783),m=new WeakMap,g=new WeakSet,_=new WeakSet,b=new WeakSet;class y{get symbolTree(){return(0,n._)(this,m)||(0,r._)(this,m,(0,l._)(this,b,I).call(this)),(0,n._)(this,m)}initSymbols(e){return e.map(e=>{let t=this.blobLines[e.ident_utf16.start.line_number]||"",i=(0,p.N_)(e,t,{stylingDirectives:this.stylingDirectives,repo:this.repo,refInfo:this.refInfo,path:this.path});return this.lineIndexedSymbols[i.lineNumber]=i,i})}getBlobLine(e){return this.blobLines[e]||""}getSymbolOnLine(e){return this.lineIndexedSymbols[e]}createReferences(e){return e.map(e=>{let t=new u.BW({ident:e,repo:this.repo,refInfo:this.refInfo,path:this.path,isPlain:this.isPlain,source:u.u.BLOB_CONTENT});return t.setSnippet(void 0,this.stylingDirectives?.[e.start.line],this.blobLines[e.start.line],void 0),t})}getReferencesToSymbol(e){let t=N(this.blobLines,(0,d.ah)(e));return this.createReferences(t)}getReferencesToSearch(e){let t=N(this.blobLines,(0,d.tz)(e));return this.createReferences(t)}getDefinitionsAndReferences(e,t,i){this.setLoading(!0);let n=(async()=>{let n=this.getSymbolOnLine(t+1);if(n&&n.name===e)return{definitions:[n],backend:"search"};let[s,r]=await this.getAlephDefinitions(e,t,i,this.loggedIn);if("search"===r){let t=this.getLocalDefinitions(e);t.length>0&&(s=t);let i=s.find(e=>e.path===this.path&&e.repo===this.repo);i&&(s=[i]),r="search"}else{let t=this.getLocalDefinitions(e,!0);for(let i of s)""===i.kind.fullName&&i.name===e&&(i.kind=t[0]?t[0].kind:new u.v0({kind:""}))}return{definitions:s,backend:r}})(),s=(async()=>{let{definitions:t}=await n,i=t.map(e=>e.lineNumber);return{references:this.getReferencesToSymbol(e).filter(e=>!i.includes(e.lineNumber)),backend:"search"}})(),r=(async()=>{let s="SYMBOL_KIND_UNKNOWN",r=this.getSymbolOnLine(t+1);if(r)s=r.kind.enumStringVal;else{let{definitions:e}=await n;s=e[0]?.kind?.enumStringVal||s}return this.getAlephReferences(e,t,i,this.loggedIn,s)})();return{definitions:n,localReferences:s,crossReferences:(async()=>{let[e,t]=await r;return{references:e,backend:t}})(),setLoading:this.setLoading}}getLocalDefinitions(e,t=!1){let i=9,n=[];for(let s of this.symbols)s.name===e&&(s.kind.rank<i||t)&&(i=s.kind.rank,n=[s]);return n}async getAlephDefinitions(e,t,i,n){let s,r,l="search";if(""===e&&-1===t&&-1===i||!n)return[[],l];let a=(0,o.lkl)({repo:this.repo,type:"definition",q:e,language:this.language,row:t,column:i,ref:this.refInfo.name,path:this.path,codeNavContext:"BLOB_VIEW",symbolKind:null});try{s=await (0,c.lS)(a)}catch{return[[],l]}if(!s.ok)return[[],l];try{r=await s.json()}catch{return[[],l]}return l=S(r.backend)??"search",[r.payload.flatMap(e=>e).map(t=>(0,p.zs)(t,{stylingDirectives:this.stylingDirectives,repo:this.repo,refInfo:this.refInfo,path:this.path,symbol:e,backend:l})),l]}async getAlephReferences(e,t,i,n,s){let r,l="search";if(""===e&&-1===t&&-1===i||!n)return[[],l];let a=(0,o.lkl)({repo:this.repo,type:"references",q:e,language:this.language,row:t,column:i,ref:this.refInfo.name,path:this.path,codeNavContext:"BLOB_VIEW",symbolKind:s}),h=await (0,c.lS)(a);if(!h.ok)return[[],l];try{r=await h.json()}catch{return[[],l]}l=S(r.backend)??"search";let u=new Set;return[r.payload.flatMap(e=>e).reduce((e,t)=>{var i;if(t.path===this.path)return e;let n=(0,p.QV)(t,{stylingDirectives:this.stylingDirectives,repo:this.repo,refInfo:this.refInfo,path:this.path,backend:l});return i=n.lineNumber,u.has(i)||(u.add(i),0)||e.push(n),e},[]).sort((e,t)=>e.lineNumber-t.lineNumber),l]}constructor(e,t,i,n,r,o,c,u,d,f){(0,a._)(this,g),(0,a._)(this,_),(0,a._)(this,b),(0,h._)(this,"repo",void 0),(0,h._)(this,"refInfo",void 0),(0,h._)(this,"language",void 0),(0,h._)(this,"path",void 0),(0,h._)(this,"loggedIn",void 0),(0,h._)(this,"blobLines",void 0),(0,h._)(this,"symbols",void 0),(0,h._)(this,"lineIndexedSymbols",{}),(0,h._)(this,"isPlain",void 0),(0,s._)(this,m,{writable:!0,value:void 0}),(0,h._)(this,"stylingDirectives",void 0),(0,h._)(this,"setLoading",void 0),(0,h._)(this,"codeSections",void 0),(0,h._)(this,"lineToSectionMap",void 0),this.setLoading=f,this.repo=e,this.refInfo=t,this.path=i,this.loggedIn=n,this.language=u,this.blobLines=r,this.stylingDirectives=c,this.isPlain=d,this.symbols=this.initSymbols(o),(0,l._)(this,g,v).call(this);const{codeSections:p,lineToSectionMap:y}=(0,l._)(this,_,L).call(this);this.codeSections=p,this.lineToSectionMap=y}}function v(){let e=[];for(let n of this.symbols){let s=0;for(let r=e.length-1;r>=0;r--){var t,i;if(t=n,i=e[r],t.extent.start.line===i.extent.end.line?t.extent.start.column>=i.extent.end.column:t.extent.start.line>=i.extent.end.line)e.pop();else{s=e.length;break}}e.push(n),n.setSymbolDepth(s)}}function L(){let e=new Map,t=[];for(let i=0;i<this.symbols.length;i++)if(this.symbols[i].lineNumber<this.symbols[i].extent.end.line-2){let n={startLine:this.symbols[i].lineNumber,endLine:this.symbols[i].extent.end.line,index:i,collapsed:!1,level:this.symbols[i].depth};t.push(n);let s=e.get(n.startLine);s?s.push(n):e.set(n.startLine,[n]);let r=e.get(n.endLine);r?r.push(n):e.set(n.endLine,[n])}return{lineToSectionMap:new f.J(t),codeSections:e}}function I(){if(!this.symbols)return[];let e=this.symbols.filter(e=>"field"!==e.kind.fullName).map(e=>({symbol:e,depth:e.depth})),t=[];for(let i=0;i<e.length;i++){let n=e[i];if(i+1<e.length&&e[i+1].depth>n.depth){let s=function e(t,i){let n=[],s=t[i];for(let r=i+1;r<t.length;r++){let i=t[r];if(i.depth>s.depth){let s=e(t,r);r+=x(s),n.push({symbol:i.symbol,children:s,isParent:s.length>0})}else break}return n}(e,i);i+=x(s),t.push({symbol:n.symbol,isParent:!0,children:s});continue}t.push({symbol:n.symbol,isParent:!1,children:[]})}return t}function S(e){switch(e){case"ALEPH_PRECISE":case"ALEPH_PRECISE_PREVIEW":case"ALEPH_PRECISE_DEVELOPMENT":return"precise";case"BLACKBIRD":return"search";default:return null}}function x(e){let t=e.length;for(let i=0;i<e.length;i++){let n=e[i];n.isParent&&(t+=x(n.children))}return t}function N(e,t){let i=[],n=(0,d.lA)(t,e),s=n.next();for(;!s.done&&i.length<200;){let{column:e,columnEnd:t,line:r}=s.value;i.push({start:{line:r,column:e},end:{line:r,column:t}}),s=n.next()}return i}function k(e,t,i){if(0===e.length)return[];let n=e.length>=200,s={},r=e.reduce((e,n)=>{if(s[n.ident.start.line])return e;s[n.ident.start.line]=!0;let r=(0,d.lA)(i,[t[n.ident.start.line]]),l=r.next();for(;!l.done&&e.length<200;){let{column:t,columnEnd:i}=l.value;e.push({start:{line:n.ident.start.line,column:t},end:{line:n.ident.start.line,column:i}}),l=r.next()}return e},[]);if(r.length<200&&n){let n=e[e.length-1].ident.start.line,s=(0,d.lA)(i,t,n),l=s.next();for(;!l.done&&r.length<200;){let{line:e,column:t,columnEnd:i}=l.value;r.push({start:{line:e,column:t},end:{line:e,column:i}}),l=s.next()}}return r}},85020(e,t,i){i.d(t,{AP:()=>a,BW:()=>h,u:()=>r,v0:()=>l});var n=i(50467),s=i(35148);let r={BLACKBIRD_SEARCH:"blackbird-search",BLACKBIRD_ANALYSIS:"blackbird-analysis",ALEPH_PRECISE:"aleph-precise",BLOB_CONTENT:"blob-content-search"};class l{constructor({kind:e}){(0,n._)(this,"enumStringVal",void 0),(0,n._)(this,"fullName",void 0),(0,n._)(this,"shortName",void 0),(0,n._)(this,"plColor",void 0),(0,n._)(this,"rank",void 0);const[t,i]=function(e){if("string"==typeof e){let t=e.toString().replace("SYMBOL_KIND_","").replace(/_DEF$/,"").replace(/_REF$/,"").toLowerCase();if(e.startsWith("SYMBOL_KIND_"))return[t,e.toString()];if(""!==e&&"unknown"!==e){let t=`SYMBOL_KIND_${e.toUpperCase()}`;return"call"===e?t+="_REF":t+="_DEF",[e,t]}}return["unknown","SYMBOL_KIND_UNKNOWN"]}(e);this.enumStringVal=i,this.fullName=t,this.shortName=function(e){switch(e){case"function":case"method":return"func";case"interface":return"intf";case"implementation":return"impl";case"constant":return"const";case"module":return"mod";case"section_1":return"h1";case"section_2":return"h2";case"section_3":return"h3";case"section_4":return"h4";case"section_5":return"h5";case"section_6":return"h6";case"class":case"call":case"enum":case"field":case"macro":case"struct":case"trait":case"type":case"union":return e;default:return e.substring(0,1)}}(t),this.plColor=function(e){switch(e){case"function":case"method":default:return"prettylights.syntax.entity";case"class":case"enum":case"struct":case"union":return"prettylights.syntax.constant";case"interface":case"trait":return"prettylights.syntax.keyword";case"constant":case"field":case"enum member":return"prettylights.syntax.variable";case"implementation":return"prettylights.syntax.string"}}(t),this.rank=function(e){return({class:1,struct:1,enum:1,type:2,interface:3,trait:3,module:4,implementation:5,function:6,method:7,call:8,field:9})[e]||9}(t)}}class a{setSymbolDepth(e){this.depth=e}setFileInfo(e,t,i){this.repo=e,this.refInfo=t,this.path=i}get lineNumber(){return this.ident.start.line+1}setSnippet(e,t,i,n){this.highlightedText=e,this.stylingDirectives=t,this.bodyText=i,this.leadingWhitespace=n}href(){if(!this.repo||!this.refInfo||!this.path)return`/${window.location.pathname}#L${this.lineNumber}`;let e=this.source===r.BLACKBIRD_SEARCH?this.repo.defaultBranch:this.refInfo.name||this.refInfo.currentOid;return(0,s.nD_)({owner:this.repo.ownerLogin,repo:this.repo.name,commitish:e,filePath:this.path,lineNumber:this.lineNumber})}pathKey(){return`${this.repo.ownerLogin}/${this.repo.name}/${this.refInfo.currentOid}/${this.path}`}constructor({ident:e,extent:t,kind:i,name:s,fullyQualifiedName:r,source:a}){(0,n._)(this,"ident",void 0),(0,n._)(this,"extent",void 0),(0,n._)(this,"kind",void 0),(0,n._)(this,"name",void 0),(0,n._)(this,"fullyQualifiedName",void 0),(0,n._)(this,"highlightedText",void 0),(0,n._)(this,"stylingDirectives",void 0),(0,n._)(this,"leadingWhitespace",void 0),(0,n._)(this,"source",void 0),this.ident=e,this.extent=t,this.kind=new l({kind:i}),this.name=s,this.fullyQualifiedName=r,this.source=a}}class h{get lineNumber(){return this.ident.start.line+1}href(e){if(!this.repo||!this.refInfo||!this.path)return`/${window.location.pathname}#L${this.lineNumber}`;let t=this.source===r.BLACKBIRD_SEARCH?this.repo.defaultBranch:this.refInfo.name||this.refInfo.currentOid,i={owner:this.repo.ownerLogin,repo:this.repo.name,commitish:t,filePath:this.path,lineNumber:this.lineNumber,plain:this.isPlain?1:void 0};return e?(0,s.buO)(i):(0,s.nD_)(i)}setSnippet(e,t,i,n){this.highlightedText=e,this.stylingDirectives=t,this.bodyText=i,this.leadingWhitespace=n}pathKey(){return`${this.repo.ownerLogin}/${this.repo.name}/${this.refInfo.currentOid}/${this.path}`}constructor({ident:e,repo:t,refInfo:i,path:s,isPlain:r,source:l}){(0,n._)(this,"ident",void 0),(0,n._)(this,"repo",void 0),(0,n._)(this,"refInfo",void 0),(0,n._)(this,"path",void 0),(0,n._)(this,"isPlain",void 0),(0,n._)(this,"highlightedText",void 0),(0,n._)(this,"stylingDirectives",void 0),(0,n._)(this,"source",void 0),(0,n._)(this,"leadingWhitespace",void 0),this.ident=e,this.repo=t,this.refInfo=i,this.path=s,this.isPlain=r??!1,this.source=l}}},73652(e,t,i){i.d(t,{ah:()=>s,lA:()=>l,tz:()=>r});let n="Symbol";function s(e){return{kind:n,regexp:RegExp(`(\\W|^)${e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\W|$)`,"g")}}function r(e){return{kind:"Text",regexp:RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")}}function*l(e,t,i=0){for(let s=i;s<t.length;s++){let i,r=t[s];for(;null!==(i=e.regexp.exec(r));){let t=i[0],l=i.index;e.kind===n&&(t.length>0&&/\W/.test(t[0])&&(t=t.substring(1),l+=i[0].length-t.length),t.length>0&&/\W/.test(t[t.length-1])&&(t=t.substring(0,t.length-1))),yield{line:s,column:l,columnEnd:l+t.length,text:r}}}}},69710(e,t,i){i.d(t,{J:()=>u});var n=i(35750),s=i(18150),r=i(85242),l=i(88243),a=i(16213),h=new WeakMap,o=new WeakMap,c=new WeakSet;class u{get(e){let t,i=(0,l._)(this,c,d).call(this,e);for(let s=i-1;s>=0&&!((0,n._)(this,o)[s]<=e);s--){let i=(0,n._)(this,h)[s];e<i.endLine&&(t||(t=[]),t.push(i))}return t&&t.length>1&&t.reverse(),t}constructor(e){(0,a._)(this,c),(0,s._)(this,h,{writable:!0,value:void 0}),(0,s._)(this,o,{writable:!0,value:void 0}),(0,r._)(this,h,e.slice().sort((e,t)=>e.startLine-t.startLine));const t=(0,n._)(this,h).length;if((0,r._)(this,o,Array(t)),t>0){(0,n._)(this,o)[0]=(0,n._)(this,h)[0].endLine;for(let e=1;e<t;e++)(0,n._)(this,o)[e]=Math.max((0,n._)(this,o)[e-1],(0,n._)(this,h)[e].endLine)}}}function d(e){let t=0,i=(0,n._)(this,h).length;for(;t<i;){let s=t+i>>>1;(0,n._)(this,h)[s].startLine<e?t=s+1:i=s}return t}},98783(e,t,i){i.d(t,{N_:()=>s,QV:()=>l,zs:()=>r});var n=i(85020);function s(e,t,{stylingDirectives:i,repo:s,refInfo:r,path:l}){let{extent_utf16:a,ident_utf16:h}=e,o=new n.AP({kind:e.kind,fullyQualifiedName:e.fully_qualified_name,name:e.name,extent:{start:{line:a.start.line_number,column:a.start.utf16_col},end:{line:a.end.line_number,column:a.end.utf16_col}},ident:{start:{line:h.start.line_number,column:h.start.utf16_col},end:{line:h.end.line_number,column:h.end.utf16_col}},source:n.u.BLACKBIRD_ANALYSIS});return o.setSnippet(void 0,i?.[h.start.line_number],t,void 0),o.setFileInfo(s,r,l),o}function r(e,{symbol:t,refInfo:i,repo:s,path:r,backend:l}){let a=e.ident?.start?.character,h=e.ident?.end?.character??e.ident?.start?.character,o={start:{line:e.ident.start.line,column:a?a-e.leadingWhitespace:0},end:{line:e.ident?.end?.line??e.ident.start.line,column:h?h-e.leadingWhitespace:0}},c=e.extent?.start?.character,u=e.extent?.end?.character??e.extent?.start?.character,d={start:{line:e.extent.start.line,column:c||0},end:{line:e.extent.end?.line??e.extent.start.line,column:u||0}},f=new n.AP({ident:o,extent:d,kind:e.symbolKind,name:t,fullyQualifiedName:t,source:"search"===l?n.u.BLACKBIRD_SEARCH:n.u.ALEPH_PRECISE});if(e.local)f.setFileInfo(s,i,r);else if(e.commitOid&&e.path){let t=i;e.commitOid!==i.currentOid&&(t={name:"",listCacheKey:e.commitOid,currentOid:e.commitOid,canEdit:!1}),f.setFileInfo(e.repo??s,t,e.path)}let p=Array(e.leadingWhitespace).fill(" ").join("")+(e.firstLine||"");return f.setSnippet(e.highlightedText,void 0,p,e.leadingWhitespace),f}function l(e,{refInfo:t,path:i,repo:s,backend:r}){let l=t,a=i;!e.local&&e.commitOid&&e.path&&(l=t,a=e.path,e.commitOid!==t.currentOid&&(l={name:"",listCacheKey:e.commitOid,currentOid:e.commitOid,canEdit:!1}));let h=e.ident.start.character,o=e.ident.end?.character,c=new n.BW({repo:s,refInfo:l,path:a,ident:{start:{line:e.ident.start.line,column:h?h-e.leadingWhitespace:0},end:{line:e.ident.end?.line||e.ident.start.line,column:o?o-e.leadingWhitespace:0}},source:"search"===r?n.u.BLACKBIRD_SEARCH:n.u.ALEPH_PRECISE}),u=Array(e.leadingWhitespace).fill(" ").join("")+(e.firstLine||"");return c.setSnippet(e.highlightedText,void 0,u,e.leadingWhitespace),c}},51495(e,t,i){i.d(t,{d:()=>n});function n(e,t,i){return[...function*(e,t){for(let i of e){let e=t(i);null!=e&&(yield e)}}(e,e=>{let i=t(e);return null!=i?[e,i]:null})].sort((e,t)=>i(e[1],t[1])).map(([e])=>e)}}}]);
//# sourceMappingURL=73494-540182b632e1b952-84b614fb83a11d1b.js.map